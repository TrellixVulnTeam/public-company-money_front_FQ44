{"ast":null,"code":"import _toConsumableArray from\"/Users/sm/Desktop/\\u1100\\u1162\\u110B\\u1175\\u11AB/02.\\u1109\\u1161\\u110B\\u1175\\u1103\\u1173\\u1111\\u1173\\u1105\\u1169\\u110C\\u1166\\u11A8\\u1110\\u1173/01.company_money/pjt/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/sm/Desktop/\\u1100\\u1162\\u110B\\u1175\\u11AB/02.\\u1109\\u1161\\u110B\\u1175\\u1103\\u1173\\u1111\\u1173\\u1105\\u1169\\u110C\\u1166\\u11A8\\u1110\\u1173/01.company_money/pjt/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import moment from'moment';import{Card,Col,Row,Modal,Button,Comment,List,Input,Form,notification}from'antd';import{EditOutlined,UserOutlined,KeyOutlined,SmileOutlined}from'@ant-design/icons';import{FcCollaboration}from\"react-icons/fc\";import{axiosInstance}from'../../../api';import'../speach/Speach.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Speach=function Speach(_ref){var uniq_num=_ref.uniq_num;var TextArea=Input.TextArea;var commentUrl=\"/api/comment/\".concat(uniq_num);var idUrl=\"/api/first_money/\".concat(uniq_num);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),comment=_useState2[0],setComment=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),companyId=_useState4[0],setCompanyId=_useState4[1];useEffect(function(){axiosInstance.get(commentUrl).then(function(response){var data=response.data;setComment(data);}).catch(function(error){// console.log(error)\n});axiosInstance.get(idUrl).then(function(response){var data=response.data;setCompanyId(data.company.id);}).catch(function(error){// console.log(error)\n});},[]);var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),modalVisible=_useState6[0],setModalVisible=_useState6[1];var modal=function modal(value){setModalVisible(value);};var onFinish=function onFinish(values){var company=values.company,username=values.username,password=values.password,content=values.content;var data={company:company,username:username,password:password,content:content};var headers={\"contentType\":\"application/json\"};axiosInstance.post(\"/api/comment/\",data,headers).then(function(response){console.log(\"???\",response);notification.open({message:'작성 완료',icon:/*#__PURE__*/_jsx(SmileOutlined,{style:{color:'#108ee9'}})});modal(false);setComment([].concat(_toConsumableArray(comment),[response.data]));}).catch(function(error){console.log(\"에러임\",error);console.log(\"에러임2\",error.response.data);notification.open({message:'작성이 완료되지 않았습니다 :(',icon:/*#__PURE__*/_jsx(SmileOutlined,{style:{color:'#108ee9'}})});});};var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),commentModal=_useState8[0],setCommentModal=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),commentId=_useState10[0],setCommentId=_useState10[1];var handleRemove=function handleRemove(id){setCommentId(id);setCommentModal(true);};var checkPassword=function checkPassword(values){var password=values.password;var deleteUrl=\"/api/comment/delete/\".concat(commentId);axiosInstance.post(deleteUrl,values).then(function(response){setComment(comment.filter(function(comment){return comment.id!==commentId;}));setCommentModal(false);notification.open({message:'댓글 삭제 완료',icon:/*#__PURE__*/_jsx(SmileOutlined,{style:{color:'#ff0000'}})});}).catch(function(error){notification.open({message:'댓글 삭제가 되지 않았습니다 :(',icon:/*#__PURE__*/_jsx(SmileOutlined,{style:{color:'#ff0000'}})});});};return/*#__PURE__*/_jsx(Row,{className:\"card_section\",children:/*#__PURE__*/_jsx(Col,{xs:{span:24},sm:{span:14,offset:5},children:/*#__PURE__*/_jsxs(Card,{title:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"title_logo\",children:/*#__PURE__*/_jsx(FcCollaboration,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"title_content\",children:\"\\uC758\\uACAC\"})]}),style:{width:\"100%\"},children:[/*#__PURE__*/_jsxs(Row,{className:\"replies_write\",children:[/*#__PURE__*/_jsx(Col,{span:12,children:\"\".concat(comment.length,\" replies\")}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsxs(Button,{size:\"small\",type:\"primary\",onClick:function onClick(){return modal(true);},children:[/*#__PURE__*/_jsx(EditOutlined,{}),\" \\uAE00\\uC4F0\\uAE30\"]})})]}),/*#__PURE__*/_jsx(Modal,{title:\"\\uC5EC\\uB7EC\\uBD84\\uB4E4\\uC758 \\uC758\\uACAC\\uC744 \\uC801\\uC5B4\\uC8FC\\uC138\\uC694 :)\",centered:true,visible:modalVisible,onCancel:function onCancel(){return modal(false);},width:1000,okText:'게시',cancelText:'취소',children:/*#__PURE__*/_jsxs(Form,{onFinish:onFinish,children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{xs:{span:24},sm:{span:11},children:[/*#__PURE__*/_jsx(Form.Item,{name:\"company\",hidden:true,initialValue:companyId}),/*#__PURE__*/_jsx(Form.Item,{name:\"username\",rules:[{required:true,message:'닉네임을 입력해주세요'},{min:3,message:'3글자 이상 입력해 주세요 :D'},{max:10,message:'최대 10글자까지 입력할 수 있어요 :D'}],children:/*#__PURE__*/_jsx(Input,{size:\"large\",prefix:/*#__PURE__*/_jsx(UserOutlined,{}),placeholder:\"* \\uB2C9\\uB124\\uC784(3\\uAE00\\uC790-10\\uAE00\\uC790)\",maxLength:10})})]}),/*#__PURE__*/_jsx(Col,{xs:{span:24},sm:{span:11,offset:2},children:/*#__PURE__*/_jsx(Form.Item,{name:\"password\",rules:[{required:true,message:'비밀번호를 입력해 주세요 :D'},{min:4,message:'4자를 입력해 주세요 :D'},{max:4,message:'4자를 입력해 주세요 :D'}],children:/*#__PURE__*/_jsx(Input.Password,{size:\"large\",prefix:/*#__PURE__*/_jsx(KeyOutlined,{}),placeholder:\"* \\uBE44\\uBC00\\uBC88\\uD638(4\\uC790\\uB9AC)\",maxLength:4})})})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Form.Item,{name:\"content\",rules:[{required:true,message:'내용을 입력해 주세요 :D'},{min:3,message:'3글자 이상 입력해 주세요 :D'},{max:500,message:'최대 500글자까지 입력할 수 있어요 :D'}],children:/*#__PURE__*/_jsx(TextArea,{placeholder:\"\\uB0B4\\uC6A9\\uC744 \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694 :)\",autoSize:{minRows:6,maxRows:10},showCount:true,maxLength:500})})}),/*#__PURE__*/_jsx(\"hr\",{className:\"modal-hr\"}),/*#__PURE__*/_jsx(Form.Item,{className:\"post-button\",children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:\"\\uAC8C\\uC2DC\"})})]})}),/*#__PURE__*/_jsx(List,{itemLayout:\"horizontal\",dataSource:comment,renderItem:function renderItem(comment){return/*#__PURE__*/_jsx(\"li\",{id:comment.id,children:/*#__PURE__*/_jsx(Comment,{actions:[/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return handleRemove(comment.id);},children:\"\\uC0AD\\uC81C\"})],author:comment.username,avatar:\"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png\",content:comment.content,datetime:moment(comment.created_at.split('.')[0],'YYYY.MM.DD.HH.mm.ss ').fromNow()})});}}),/*#__PURE__*/_jsx(Modal,{title:\"\\uBE44\\uBC00\\uBC88\\uD638(4\\uC790\\uB9AC)\",centered:true,visible:commentModal,onOk:function onOk(){return checkPassword;},onCancel:function onCancel(){return setCommentModal(false);},children:/*#__PURE__*/_jsxs(Form,{name:\"comment_delete\",initialValues:{remember:true},onFinish:checkPassword,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"password\",rules:[{required:true,message:'비밀번호를 입력해 주세요 :D'},{min:4,message:'4자를 입력해 주세요 :D'},{max:4,message:'4자를 입력해 주세요 :D'}],children:/*#__PURE__*/_jsx(Input.Password,{maxLength:4})}),/*#__PURE__*/_jsx(Col,{xs:{span:24},children:/*#__PURE__*/_jsx(Form.Item,{className:\"post-button\",children:/*#__PURE__*/_jsx(Button,{type:\"danger\",htmlType:\"submit\",children:\"\\uC0AD\\uC81C\"})})})]})})]})})});};export default Speach;","map":{"version":3,"sources":["/Users/sm/Desktop/개인/02.사이드프로젝트/01.company_money/pjt/frontend/src/components/rank/speach/Speach.js"],"names":["React","useEffect","useState","moment","Card","Col","Row","Modal","Button","Comment","List","Input","Form","notification","EditOutlined","UserOutlined","KeyOutlined","SmileOutlined","FcCollaboration","axiosInstance","Speach","uniq_num","TextArea","commentUrl","idUrl","comment","setComment","companyId","setCompanyId","get","then","response","data","catch","error","company","id","modalVisible","setModalVisible","modal","value","onFinish","values","username","password","content","headers","post","console","log","open","message","icon","color","commentModal","setCommentModal","commentId","setCommentId","handleRemove","checkPassword","deleteUrl","filter","span","offset","width","length","required","min","max","minRows","maxRows","created_at","split","fromNow","remember"],"mappings":"8kBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,CACA,OAASC,IAAT,CAAeC,GAAf,CAAoBC,GAApB,CAAyBC,KAAzB,CAAgCC,MAAhC,CAAwCC,OAAxC,CAAiDC,IAAjD,CAAuDC,KAAvD,CAA8DC,IAA9D,CAAoEC,YAApE,KAAwF,MAAxF,CACA,OAASC,YAAT,CAAsBC,YAAtB,CAAoCC,WAApC,CAAiDC,aAAjD,KAAsE,mBAAtE,CACA,OAASC,eAAT,KAAgC,gBAAhC,CACA,OAASC,aAAT,KAA8B,cAA9B,CACA,MAAO,uBAAP,C,wFAKA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,MAAgB,IAAdC,CAAAA,QAAc,MAAdA,QAAc,IACnBC,CAAAA,QADmB,CACNX,KADM,CACnBW,QADmB,CAG3B,GAAMC,CAAAA,UAAU,wBAAmBF,QAAnB,CAAhB,CACA,GAAMG,CAAAA,KAAK,4BAAuBH,QAAvB,CAAX,CAJ2B,cAKGnB,QAAQ,CAAC,EAAD,CALX,wCAKpBuB,OALoB,eAKXC,UALW,8BAMOxB,QAAQ,EANf,yCAMpByB,SANoB,eAMTC,YANS,eAO3B3B,SAAS,CAAC,UAAM,CACdkB,aAAa,CAACU,GAAd,CAAkBN,UAAlB,EACGO,IADH,CACQ,SAAAC,QAAQ,CAAI,IACTC,CAAAA,IADS,CACDD,QADC,CACTC,IADS,CAEhBN,UAAU,CAACM,IAAD,CAAV,CACD,CAJH,EAKGC,KALH,CAKS,SAAAC,KAAK,CAAI,CACd;AACD,CAPH,EASAf,aAAa,CAACU,GAAd,CAAkBL,KAAlB,EACGM,IADH,CACQ,SAAAC,QAAQ,CAAI,IACTC,CAAAA,IADS,CACDD,QADC,CACTC,IADS,CAEhBJ,YAAY,CAACI,IAAI,CAACG,OAAL,CAAaC,EAAd,CAAZ,CACD,CAJH,EAKGH,KALH,CAKS,SAAAC,KAAK,CAAI,CACd;AACD,CAPH,EASD,CAnBQ,CAmBN,EAnBM,CAAT,CAP2B,eA+BahC,QAAQ,CAAC,KAAD,CA/BrB,yCA+BpBmC,YA/BoB,eA+BNC,eA/BM,eAiC3B,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,KAAD,CAAW,CACvBF,eAAe,CAACE,KAAD,CAAf,CACD,CAFD,CAIA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,MAAD,CAAY,IACpBP,CAAAA,OADoB,CACoBO,MADpB,CACpBP,OADoB,CACXQ,QADW,CACoBD,MADpB,CACXC,QADW,CACDC,QADC,CACoBF,MADpB,CACDE,QADC,CACSC,OADT,CACoBH,MADpB,CACSG,OADT,CAE3B,GAAMb,CAAAA,IAAI,CAAG,CAACG,OAAO,CAAPA,OAAD,CAAUQ,QAAQ,CAARA,QAAV,CAAoBC,QAAQ,CAARA,QAApB,CAA8BC,OAAO,CAAPA,OAA9B,CAAb,CACA,GAAMC,CAAAA,OAAO,CAAG,CACd,cAAe,kBADD,CAAhB,CAGA3B,aAAa,CAAC4B,IAAd,CAAmB,eAAnB,CAAoCf,IAApC,CAA0Cc,OAA1C,EACGhB,IADH,CACQ,SAAAC,QAAQ,CAAI,CACfiB,OAAO,CAACC,GAAR,CAAY,KAAZ,CAAmBlB,QAAnB,EACClB,YAAY,CAACqC,IAAb,CAAkB,CAChBC,OAAO,CAAE,OADO,CAEhBC,IAAI,cAAE,KAAC,aAAD,EAAe,KAAK,CAAE,CAACC,KAAK,CAAE,SAAR,CAAtB,EAFU,CAAlB,EAKAd,KAAK,CAAC,KAAD,CAAL,CAEAb,UAAU,8BACLD,OADK,GAERM,QAAQ,CAACC,IAFD,GAAV,CAIH,CAdH,EAeGC,KAfH,CAeS,SAAAC,KAAK,CAAI,CACdc,OAAO,CAACC,GAAR,CAAY,KAAZ,CAAmBf,KAAnB,EACAc,OAAO,CAACC,GAAR,CAAY,MAAZ,CAAoBf,KAAK,CAACH,QAAN,CAAeC,IAAnC,EACAnB,YAAY,CAACqC,IAAb,CAAkB,CAChBC,OAAO,CAAE,mBADO,CAEhBC,IAAI,cAAE,KAAC,aAAD,EAAe,KAAK,CAAE,CAACC,KAAK,CAAE,SAAR,CAAtB,EAFU,CAAlB,EAID,CAtBH,EAyBD,CA/BD,CArC2B,eAuEanD,QAAQ,CAAC,KAAD,CAvErB,yCAuEpBoD,YAvEoB,eAuENC,eAvEM,8BAwEOrD,QAAQ,CAAC,CAAD,CAxEf,0CAwEpBsD,SAxEoB,gBAwETC,YAxES,gBAyE3B,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACtB,EAAD,CAAQ,CAC3BqB,YAAY,CAACrB,EAAD,CAAZ,CACAmB,eAAe,CAAC,IAAD,CAAf,CACD,CAHD,CAKA,GAAMI,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACjB,MAAD,CAAY,IACzBE,CAAAA,QADyB,CACbF,MADa,CACzBE,QADyB,CAGhC,GAAMgB,CAAAA,SAAS,+BAA0BJ,SAA1B,CAAf,CACArC,aAAa,CAAC4B,IAAd,CAAmBa,SAAnB,CAA8BlB,MAA9B,EACGZ,IADH,CACQ,SAAAC,QAAQ,CAAI,CAEhBL,UAAU,CAACD,OAAO,CAACoC,MAAR,CAAe,SAAApC,OAAO,QAAIA,CAAAA,OAAO,CAACW,EAAR,GAAeoB,SAAnB,EAAtB,CAAD,CAAV,CACAD,eAAe,CAAC,KAAD,CAAf,CAEA1C,YAAY,CAACqC,IAAb,CAAkB,CAChBC,OAAO,CAAE,UADO,CAEhBC,IAAI,cAAE,KAAC,aAAD,EAAe,KAAK,CAAE,CAACC,KAAK,CAAE,SAAR,CAAtB,EAFU,CAAlB,EAID,CAVH,EAWGpB,KAXH,CAWS,SAAAC,KAAK,CAAI,CACdrB,YAAY,CAACqC,IAAb,CAAkB,CAChBC,OAAO,CAAE,oBADO,CAEhBC,IAAI,cAAE,KAAC,aAAD,EAAe,KAAK,CAAE,CAACC,KAAK,CAAE,SAAR,CAAtB,EAFU,CAAlB,EAID,CAhBH,EAiBD,CArBD,CAuBA,mBACI,KAAC,GAAD,EAAK,SAAS,CAAC,cAAf,uBACI,KAAC,GAAD,EAAK,EAAE,CAAE,CAACS,IAAI,CAAE,EAAP,CAAT,CAAqB,EAAE,CAAE,CAAEA,IAAI,CAAE,EAAR,CAAYC,MAAM,CAAE,CAApB,CAAzB,uBACI,MAAC,IAAD,EACE,KAAK,cACH,qCACI,YAAK,SAAS,CAAC,YAAf,uBAA4B,KAAC,eAAD,IAA5B,EADJ,cAEI,YAAK,SAAS,CAAC,eAAf,0BAFJ,GAFJ,CAOE,KAAK,CAAE,CAAEC,KAAK,CAAE,MAAT,CAPT,wBAUA,MAAC,GAAD,EAAK,SAAS,CAAC,eAAf,wBACE,KAAC,GAAD,EAAK,IAAI,CAAE,EAAX,oBACMvC,OAAO,CAACwC,MADd,cADF,cAIE,KAAC,GAAD,EAAK,IAAI,CAAE,EAAX,uBACE,MAAC,MAAD,EAAQ,IAAI,CAAC,OAAb,CAAqB,IAAI,CAAC,SAA1B,CAAoC,OAAO,CAAE,yBAAM1B,CAAAA,KAAK,CAAC,IAAD,CAAX,EAA7C,wBACE,KAAC,YAAD,IADF,yBADF,EAJF,GAVA,cAqBA,KAAC,KAAD,EACE,KAAK,CAAC,qFADR,CAEE,QAAQ,KAFV,CAGE,OAAO,CAAEF,YAHX,CAIE,QAAQ,CAAE,0BAAME,CAAAA,KAAK,CAAC,KAAD,CAAX,EAJZ,CAKE,KAAK,CAAE,IALT,CAME,MAAM,CAAE,IANV,CAOE,UAAU,CAAE,IAPd,uBASE,MAAC,IAAD,EAAM,QAAQ,CAAEE,QAAhB,wBACA,kCACA,MAAC,GAAD,yBACE,MAAC,GAAD,EAAK,EAAE,CAAE,CAACqB,IAAI,CAAE,EAAP,CAAT,CAAqB,EAAE,CAAE,CAAEA,IAAI,CAAE,EAAR,CAAzB,wBACA,KAAC,IAAD,CAAM,IAAN,EACI,IAAI,CAAC,SADT,CAEI,MAAM,CAAE,IAFZ,CAGI,YAAY,CAAEnC,SAHlB,EADA,cAOE,KAAC,IAAD,CAAM,IAAN,EACE,IAAI,CAAC,UADP,CAEE,KAAK,CAAE,CACL,CAAEuC,QAAQ,CAAE,IAAZ,CAAkBf,OAAO,CAAE,aAA3B,CADK,CAEL,CAAEgB,GAAG,CAAE,CAAP,CAAUhB,OAAO,CAAE,mBAAnB,CAFK,CAGL,CAAEiB,GAAG,CAAE,EAAP,CAAWjB,OAAO,CAAE,wBAApB,CAHK,CAFT,uBAQE,KAAC,KAAD,EAAO,IAAI,CAAC,OAAZ,CAAoB,MAAM,cAAE,KAAC,YAAD,IAA5B,CAA6C,WAAW,CAAC,oDAAzD,CAA2E,SAAS,CAAE,EAAtF,EARF,EAPF,GADF,cAoBE,KAAC,GAAD,EAAK,EAAE,CAAE,CAACW,IAAI,CAAE,EAAP,CAAT,CAAqB,EAAE,CAAE,CAAEA,IAAI,CAAE,EAAR,CAAYC,MAAM,CAAE,CAApB,CAAzB,uBACE,KAAC,IAAD,CAAM,IAAN,EACE,IAAI,CAAC,UADP,CAEE,KAAK,CAAE,CACL,CAAEG,QAAQ,CAAE,IAAZ,CAAkBf,OAAO,CAAE,kBAA3B,CADK,CAEL,CAAEgB,GAAG,CAAE,CAAP,CAAUhB,OAAO,CAAE,gBAAnB,CAFK,CAGL,CAAEiB,GAAG,CAAE,CAAP,CAAUjB,OAAO,CAAE,gBAAnB,CAHK,CAFT,uBAQE,KAAC,KAAD,CAAO,QAAP,EAAgB,IAAI,CAAC,OAArB,CAA6B,MAAM,cAAE,KAAC,WAAD,IAArC,CAAqD,WAAW,CAAC,2CAAjE,CAA+E,SAAS,CAAE,CAA1F,EARF,EADF,EApBF,GADA,EADA,cAoCA,kCACA,KAAC,IAAD,CAAM,IAAN,EACM,IAAI,CAAC,SADX,CAGM,KAAK,CAAE,CACL,CAAEe,QAAQ,CAAE,IAAZ,CAAkBf,OAAO,CAAE,gBAA3B,CADK,CAEL,CAAEgB,GAAG,CAAE,CAAP,CAAUhB,OAAO,CAAE,mBAAnB,CAFK,CAGL,CAAEiB,GAAG,CAAE,GAAP,CAAYjB,OAAO,CAAE,yBAArB,CAHK,CAHb,uBASE,KAAC,QAAD,EACE,WAAW,CAAC,4DADd,CAEE,QAAQ,CAAE,CAAEkB,OAAO,CAAE,CAAX,CAAcC,OAAO,CAAE,EAAvB,CAFZ,CAGE,SAAS,KAHX,CAGY,SAAS,CAAE,GAHvB,EATF,EADA,EApCA,cAqDA,WAAI,SAAS,CAAC,UAAd,EArDA,cAsDA,KAAC,IAAD,CAAM,IAAN,EAAW,SAAS,CAAC,aAArB,uBACE,KAAC,MAAD,EAAQ,IAAI,CAAC,SAAb,CAAuB,QAAQ,CAAC,QAAhC,0BADF,EAtDA,GATF,EArBA,cA4FA,KAAC,IAAD,EACE,UAAU,CAAC,YADb,CAEE,UAAU,CAAE7C,OAFd,CAGE,UAAU,CAAE,oBAACA,OAAD,qBACV,WAAI,EAAE,CAAEA,OAAO,CAACW,EAAhB,uBACE,KAAC,OAAD,EACE,OAAO,CAAE,cAAC,aAAM,OAAO,CAAE,yBAAMsB,CAAAA,YAAY,CAACjC,OAAO,CAACW,EAAT,CAAlB,EAAf,0BAAD,CADX,CAEE,MAAM,CAAEX,OAAO,CAACkB,QAFlB,CAGE,MAAM,CAAE,kEAHV,CAIE,OAAO,CAAElB,OAAO,CAACoB,OAJnB,CAKE,QAAQ,CACN1C,MAAM,CAACsB,OAAO,CAAC8C,UAAR,CAAmBC,KAAnB,CAAyB,GAAzB,EAA8B,CAA9B,CAAD,CAAoC,sBAApC,CAAN,CAAkEC,OAAlE,EANJ,EADF,EADU,EAHd,EA5FA,cAgHA,KAAC,KAAD,EACE,KAAK,CAAC,yCADR,CAEE,QAAQ,KAFV,CAGE,OAAO,CAAEnB,YAHX,CAIE,IAAI,CAAE,sBAAMK,CAAAA,aAAN,EAJR,CAKE,QAAQ,CAAE,0BAAMJ,CAAAA,eAAe,CAAC,KAAD,CAArB,EALZ,uBAOE,MAAC,IAAD,EACA,IAAI,CAAC,gBADL,CAEA,aAAa,CAAE,CAAEmB,QAAQ,CAAE,IAAZ,CAFf,CAGA,QAAQ,CAAEf,aAHV,wBAKE,KAAC,IAAD,CAAM,IAAN,EACE,IAAI,CAAC,UADP,CAEE,KAAK,CAAE,CACH,CAAEO,QAAQ,CAAE,IAAZ,CAAkBf,OAAO,CAAE,kBAA3B,CADG,CAEH,CAAEgB,GAAG,CAAE,CAAP,CAAUhB,OAAO,CAAE,gBAAnB,CAFG,CAGH,CAAEiB,GAAG,CAAE,CAAP,CAAUjB,OAAO,CAAE,gBAAnB,CAHG,CAFT,uBAQE,KAAC,KAAD,CAAO,QAAP,EAAgB,SAAS,CAAE,CAA3B,EARF,EALF,cAgBE,KAAC,GAAD,EAAK,EAAE,CAAE,CAACW,IAAI,CAAE,EAAP,CAAT,uBACE,KAAC,IAAD,CAAM,IAAN,EAAW,SAAS,CAAC,aAArB,uBACE,KAAC,MAAD,EAAQ,IAAI,CAAC,QAAb,CAAsB,QAAQ,CAAC,QAA/B,0BADF,EADF,EAhBF,GAPF,EAhHA,GADJ,EADJ,EADJ,CAwJH,CA7PD,CA+PA,cAAe1C,CAAAA,MAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport moment from 'moment';\nimport { Card, Col, Row, Modal, Button, Comment, List, Input, Form, notification } from 'antd';\nimport { EditOutlined,UserOutlined, KeyOutlined, SmileOutlined } from '@ant-design/icons';\nimport { FcCollaboration } from \"react-icons/fc\";\nimport { axiosInstance } from '../../../api';\nimport '../speach/Speach.scss';\n\n\n\n\nconst Speach = ({uniq_num}) => {\n    const { TextArea } = Input;\n\n    const commentUrl = `/api/comment/${uniq_num}`;\n    const idUrl = `/api/first_money/${uniq_num}`;\n    const [comment, setComment] = useState([])\n    const [companyId, setCompanyId] = useState();\n    useEffect(() => {\n      axiosInstance.get(commentUrl)\n        .then(response => {\n          const {data} = response;\n          setComment(data);\n        })\n        .catch(error => {\n          // console.log(error)\n        })\n\n      axiosInstance.get(idUrl)\n        .then(response => {\n          const {data} = response;\n          setCompanyId(data.company.id);\n        })\n        .catch(error => {\n          // console.log(error)\n        })\n\n    }, [])\n\n\n\n\n    const [modalVisible, setModalVisible] = useState(false);\n\n    const modal = (value) => {\n      setModalVisible(value)\n    } \n\n    const onFinish = (values) => {\n      const {company, username, password, content} = values;\n      const data = {company, username, password, content}\n      const headers = {\n        \"contentType\": \"application/json\"\n      }\n      axiosInstance.post(\"/api/comment/\", data, headers)\n        .then(response => {\n           console.log(\"???\", response)\n            notification.open({\n              message: '작성 완료',\n              icon: <SmileOutlined style={{color: '#108ee9'}}/>\n            })\n\n            modal(false)\n\n            setComment([\n              ...comment,\n              response.data\n            ])\n        })\n        .catch(error => {\n          console.log(\"에러임\", error)\n          console.log(\"에러임2\", error.response.data)\n          notification.open({\n            message: '작성이 완료되지 않았습니다 :(',\n            icon: <SmileOutlined style={{color: '#108ee9'}}/>\n          })\n        })\n\n      \n    };\n\n\n    const [commentModal, setCommentModal] = useState(false)\n    const [commentId, setCommentId] = useState(0)\n    const handleRemove = (id) => {\n      setCommentId(id)\n      setCommentModal(true)\n    }\n\n    const checkPassword = (values) => {\n      const {password} = values\n\n      const deleteUrl = `/api/comment/delete/${commentId}`;\n      axiosInstance.post(deleteUrl, values)\n        .then(response => {\n\n          setComment(comment.filter(comment => comment.id !== commentId))\n          setCommentModal(false)\n\n          notification.open({\n            message: '댓글 삭제 완료',\n            icon: <SmileOutlined style={{color: '#ff0000'}}/>\n          })\n        })\n        .catch(error => {\n          notification.open({\n            message: '댓글 삭제가 되지 않았습니다 :(',\n            icon: <SmileOutlined style={{color: '#ff0000'}}/>\n          })\n        })\n    }\n\n    return (\n        <Row className=\"card_section\">\n            <Col xs={{span: 24}} sm={{ span: 14, offset: 5 }}>\n                <Card \n                  title={\n                    <span>\n                        <div className='title_logo'><FcCollaboration/></div> \n                        <div className='title_content'>의견</div>\n                    </span>\n                  } \n                  style={{ width: \"100%\" }}\n                >\n                \n                <Row className='replies_write'>\n                  <Col span={12}>\n                    {`${comment.length} replies`}\n                  </Col>\n                  <Col span={12}>\n                    <Button size=\"small\" type=\"primary\" onClick={() => modal(true)}>\n                      <EditOutlined/> 글쓰기\n                    </Button>\n                  </Col>\n                </Row>\n                \n                <Modal\n                  title=\"여러분들의 의견을 적어주세요 :)\"\n                  centered\n                  visible={modalVisible}\n                  onCancel={() => modal(false)}\n                  width={1000}\n                  okText={'게시'}\n                  cancelText={'취소'}\n                >\n                  <Form onFinish={onFinish}>\n                  <div>\n                  <Row>\n                    <Col xs={{span: 24}} sm={{ span: 11 }}>    \n                    <Form.Item\n                        name=\"company\"\n                        hidden={true}\n                        initialValue={companyId}\n                      >\n                      </Form.Item>\n                      <Form.Item\n                        name=\"username\"\n                        rules={[\n                          { required: true, message: '닉네임을 입력해주세요' },\n                          { min: 3, message: '3글자 이상 입력해 주세요 :D' },\n                          { max: 10, message: '최대 10글자까지 입력할 수 있어요 :D' }\n                        ]}\n                      >\n                        <Input size=\"large\" prefix={<UserOutlined/>} placeholder=\"* 닉네임(3글자-10글자)\" maxLength={10}/>\n                      </Form.Item>\n                    \n                    </Col>\n                    <Col xs={{span: 24}} sm={{ span: 11, offset: 2 }}>\n                      <Form.Item\n                        name=\"password\"\n                        rules={[\n                          { required: true, message: '비밀번호를 입력해 주세요 :D' },\n                          { min: 4, message: '4자를 입력해 주세요 :D' },\n                          { max: 4, message: '4자를 입력해 주세요 :D' }\n                        ]}\n                      >\n                        <Input.Password size=\"large\" prefix={<KeyOutlined/>} placeholder=\"* 비밀번호(4자리)\" maxLength={4}/>\n                      </Form.Item>\n                    </Col>\n                  </Row>\n                  </div>\n                  <div>\n                  <Form.Item\n                        name=\"content\"\n                        \n                        rules={[\n                          { required: true, message: '내용을 입력해 주세요 :D' },\n                          { min: 3, message: '3글자 이상 입력해 주세요 :D' },\n                          { max: 500, message: '최대 500글자까지 입력할 수 있어요 :D' }\n                        ]}\n                  >\n                    <TextArea  \n                      placeholder=\"내용을 입력해주세요 :)\"\n                      autoSize={{ minRows: 6, maxRows: 10 }}\n                      showCount maxLength={500} \n                    />\n                  </Form.Item>  \n                  </div>\n                  <hr className=\"modal-hr\"/>\n                  <Form.Item className='post-button'>\n                    <Button type=\"primary\" htmlType=\"submit\">\n                      게시\n                    </Button>\n                  </Form.Item>\n\n                  </Form>\n                </Modal>\n                <List\n                  itemLayout=\"horizontal\"\n                  dataSource={comment}\n                  renderItem={(comment) => (\n                    <li id={comment.id}>\n                      <Comment\n                        actions={[<span onClick={() => handleRemove(comment.id)}>삭제</span>]}\n                        author={comment.username}\n                        avatar= 'https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png'\n                        content={comment.content}\n                        datetime={\n                          moment(comment.created_at.split('.')[0],  'YYYY.MM.DD.HH.mm.ss ').fromNow()\n                        }\n                      />\n\n\n                    </li>\n                  )}\n                />\n\n                <Modal\n                  title=\"비밀번호(4자리)\"\n                  centered\n                  visible={commentModal}\n                  onOk={() => checkPassword}\n                  onCancel={() => setCommentModal(false)}\n                >\n                  <Form\n                  name=\"comment_delete\"\n                  initialValues={{ remember: true }}\n                  onFinish={checkPassword}\n                 >\n                    <Form.Item\n                      name=\"password\"\n                      rules={[\n                          { required: true, message: '비밀번호를 입력해 주세요 :D' },\n                          { min: 4, message: '4자를 입력해 주세요 :D' },\n                          { max: 4, message: '4자를 입력해 주세요 :D' }\n                      ]}\n                    >\n                      <Input.Password maxLength={4}/>\n                    </Form.Item>\n\n                    <Col xs={{span: 24}}>\n                      <Form.Item className=\"post-button\">\n                        <Button type=\"danger\" htmlType=\"submit\">\n                          삭제\n                        </Button>\n                      </Form.Item>\n                    </Col>    \n                  </Form>\n                </Modal>\n\n                </Card>\n            </Col>\n        </Row>\n    );\n};\n\nexport default Speach;"]},"metadata":{},"sourceType":"module"}